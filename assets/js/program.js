window.addEventListener("load",(()=>{document.getElementById("uploader").addEventListener("change",abrirUploader)}));var lineas=[];let fechaAnt,msgAnt,usuarios=[],userColor=[];var eng=!0,nmode=!0,msgChar=0;const months=["January","February","March","April","May","June","July","August","September","Octuber","November","December"];let warnings=["Messages and calls are","left","You're no longer","changed to","You removed","Your security code with","added","changed this group's","created group","Your'e now an admin","You created group","was added","changed the group description","joined using this group's","changed the subject","changed the group","You're now an admin","started a call"];var activeUser=document.getElementById("activeUser");function abrirUploader(e){let t=e.target.files[0],n=new FileReader;if(t){if("txt"!=t.name.substring(t.name.length-3,t.name.length))return void(document.getElementById("subtitle").textContent="Seleccione un uploader con la extensiÃ³n .txt");document.getElementById("subtitle").textContent=t.name,document.getElementById("title").remove(),document.getElementById("dia").remove(),document.getElementById("containall").remove(),document.getElementById("containmsg").remove(),document.getElementById("labArch").remove(),document.getElementById("configs").style.display="block",n.onload=function(e){let t=e.target.result;lineas=t.split("\n");var n;internationalNumberFormat=new Intl.NumberFormat("es-US"),document.getElementById("reload").style.display="flex",msgChar=internationalNumberFormat.format(parseInt(lineas.length)),n=eng?msgChar+" messagesHas been loaded ":"Se han cargado "+msgChar+" mensajes",lineas.forEach((function(e){DividirMensaje(e)})),document.getElementById("preview").textContent=n,elegirUsr(usuarios[0].substring(0,usuarios[0].length-1).split(" ").join(""))},n.readAsText(t)}else document.getElementById("subtitle").textContent=eng?"Fail to charge the file":"No se pudo cargar el uploader"}function DividirMensaje(e){let t=0,n=e,s=(e=e.split(" "))[4],a="",r=e[0],o=e[1]+" "+e[2];var l=0;try{if(n=n.replace(">","&gt;"),n=n.replace("<","&lt;"),checks(e,r))return;if(eng&&(r=r.substring(0,r.length-1)),!/^\d{1,2}\/\d{1,2}\/\d{2,4}$/.test(r))return void separateLine(a,n);if(":"==s[s.length-1]){t=5;for(var i=0;i<t;i++)l+=e[i].length}else for(i=4;i<e.length;i++)if(-1!=e[i].indexOf(":")){for(t=i+1,i=0;i<t;i++)i>=5&&(s+=" "+e[i]),l+=e[i].length;break}a=n.substring(l+t,n.length).replace(/ /g,"&nbsp"),usuarios.includes(s)||(usuarios.push(s),userColor.push("hsl("+Math.round(359*Math.random())+", 64%, 64%)"),listUsers(),createUserOption(s.substring(0,s.length-1))),AdicionMensajes(s,a,o,e)}catch(e){}}function AdicionMensajes(e,t,n,s){const a=document.createElement("div");a.textContent="",a.id="msg";const r=document.createElement("p");r.textContent=e,msgAnt==e&&(r.style.display="none");for(var o=0;o<usuarios.length;o++)usuarios[o]==e&&(r.style.color=userColor[o]);const l=document.createElement("p");l.innerHTML=t,l.id="cuerpo",l.className="cuerpocont";const i=document.createElement("p");i.textContent=n,i.id="fecha";var d=document.getElementById("area");if(fechaAnt!=s[0]){const e=document.createElement("div");e.id="containall",e.className="date";const t=document.createElement("p");var c;eng?((c=parseInt(s[0].split("/")[2].substring(0,s[0].split("/")[2].length-1)))<2e3&&(c+=2e3),t.textContent=months[s[0].split("/")[0]-1]+" "+s[0].split("/")[1]+", "+c):((c=parseInt(s[0].split("/")[2]))<2e3&&(c+=2e3),t.textContent=s[0].split("/")[0]+" de "+meses[s[0].split("/")[1]-1]+" de "+c),t.id="dia",e.append(t),d.append(e)}var u=document.createElement("div");u.id="elements";var m=document.createElement("div");m.id="containmsg",m.className="oth "+e.substring(0,e.length-1).split(" ").join(""),m.style.display="flex",u.append(r,l),a.append(u,i),m.append(a),d.append(m),fechaAnt=s[0],msgAnt=e}function advertMsg(e){let t="";for(var n=4;n<e.length;n++)t+=" "+e[n];const s=document.createElement("div");s.id="containall";const a=document.createElement("p");a.textContent=t,a.id="warn";var r=document.getElementById("area");s.append(a),r.append(s)}function listUsers(){document.getElementById("userPreview").style.display="block";const e=document.getElementById("contUsers");e.style.display="flex";const t=document.createElement("div");t.id="user",t.style.backgroundColor=userColor[userColor.length-1];const n=document.createElement("div");n.id="imagen";const s=document.createElement("span");s.textContent=usuarios[usuarios.length-1].substring(0,usuarios[usuarios.length-1].length-1),t.appendChild(n),t.appendChild(s),e.appendChild(t)}function checks(e,t){var n=!1;return eng?warnings.forEach((function(t){if(e.join(" ").includes(t)&&!e.join(" ").substring(20,e.join(" ").length).includes(":"))return advertMsg(e),n=!0,!0})):advertencias.forEach((function(t){if(e.join(" ").includes(t)&&!e.join(" ").substring(20,e.join(" ").length).includes(":"))return advertMsg(e),n=!0,!0})),n}function separateLine(e,t){e=t.replace(/ /g,"&nbsp"),document.getElementsByClassName("cuerpocont")[document.getElementsByClassName("cuerpocont").length-1].innerHTML+="<br>"+e}function createUserOption(e){const t=document.getElementById("activeUser");var n=document.createElement("option");n.value=e,n.textContent=e,t.append(n)}function elegirUsr(e){let t=document.getElementsByClassName("oth");Array.from(t).forEach((t=>{t.className.includes("env")&&(t.className=t.className.substring(0,t.className.length-3)),t.className.includes(e)&&(t.className+=" env")}))}activeUser.addEventListener("change",(function(){elegirUsr(usuarios[activeUser.selectedIndex].substring(0,usuarios[activeUser.selectedIndex].length-1).split(" ").join(""))}));